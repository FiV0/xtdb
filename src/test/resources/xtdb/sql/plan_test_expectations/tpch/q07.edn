[:project
 [{supp_nation shipping.7/supp_nation}
  {cust_nation shipping.7/cust_nation}
  {l_year shipping.7/l_year}
  revenue]
 [:order-by
  [[shipping.7/supp_nation
    {:direction :asc, :null-ordering :nulls-last}]
   [shipping.7/cust_nation
    {:direction :asc, :null-ordering :nulls-last}]
   [shipping.7/l_year {:direction :asc, :null-ordering :nulls-last}]]
  [:project
   [shipping.7/supp_nation
    shipping.7/cust_nation
    shipping.7/l_year
    {revenue _sum_out_8}]
   [:group-by
    [shipping.7/supp_nation
     shipping.7/cust_nation
     shipping.7/l_year
     {_sum_out_8 (sum shipping.7/volume)}]
    [:rename
     shipping.7
     [:project
      [{supp_nation n1.5/n_name}
       {cust_nation n2.6/n_name}
       {l_year (extract "YEAR" l.2/l_shipdate)}
       {volume (* l.2/l_extendedprice (- 1 l.2/l_discount))}]
      [:mega-join
       [(or
         (and (= n1.5/n_name "FRANCE") (= n2.6/n_name "GERMANY"))
         (and (= n1.5/n_name "GERMANY") (= n2.6/n_name "FRANCE")))]
       [[:rename n2.6 [:scan {:table #xt/table nation} [n_name]]]
        [:rename n1.5 [:scan {:table #xt/table nation} [n_name]]]
        [:rename
         c.4
         [:scan
          {:table #xt/table customer}
          [{c_nationkey (= c_nationkey nil)}]]]
        [:rename
         o.3
         [:scan
          {:table #xt/table orders}
          [{o_custkey (= nil o_custkey)}]]]
        [:rename
         s.1
         [:scan
          {:table #xt/table supplier}
          [{s_nationkey (= s_nationkey nil)}]]]
        [:rename
         l.2
         [:scan
          {:table #xt/table lineitem}
          [{l_orderkey (= nil l_orderkey)}
           {l_shipdate
            (between
             l_shipdate
             #xt/date "1995-01-01"
             #xt/date "1996-12-31")}
           l_extendedprice
           {l_suppkey (= nil l_suppkey)}
           l_discount]]]]]]]]]]]
