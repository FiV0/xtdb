[:project
 [{n_name n.5/n_name} revenue]
 [:order-by
  [[revenue {:direction :desc, :null-ordering :nulls-first}]]
  [:project
   [n.5/n_name {revenue _sum_out_7}]
   [:group-by
    [n.5/n_name {_sum_out_7 (sum _sum_in_8)}]
    [:map
     [{_sum_in_8 (* l.3/l_extendedprice (- 1 l.3/l_discount))}]
     [:mega-join
      [{c.1/c_nationkey s.4/s_nationkey}]
      [[:rename
        r.6
        [:scan {:table #xt/table region} [{r_name (= r_name "ASIA")}]]]
       [:rename
        n.5
        [:scan
         {:table #xt/table nation}
         [n_name {n_regionkey (= n_regionkey nil)}]]]
       [:rename
        s.4
        [:scan
         {:table #xt/table supplier}
         [{s_nationkey (= s_nationkey nil)}]]]
       [:rename
        l.3
        [:scan
         {:table #xt/table lineitem}
         [{l_orderkey (= l_orderkey nil)}
          l_extendedprice
          {l_suppkey (= l_suppkey nil)}
          l_discount]]]
       [:rename c.1 [:scan {:table #xt/table customer} [c_nationkey]]]
       [:rename
        o.2
        [:scan
         {:table #xt/table orders}
         [{o_orderdate
           (and
            (<
             o_orderdate
             (+
              #xt/date "1994-01-01"
              (single-field-interval "1" "YEAR" 2 6)))
            (>= o_orderdate #xt/date "1994-01-01"))}
          {o_custkey (= nil o_custkey)}]]]]]]]]]]
